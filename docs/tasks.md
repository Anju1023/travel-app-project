# タスク管理 (tasks.md)

## Phase 1: 土台作り (環境構築)

- [x] Next.js 16.1 プロジェクトの初期化
- [x] Tailwind CSS v4 の設定とカラーテーマ定義
- [x] 必要なライブラリのインストール (`@google/generative-ai`, `lucide-react` など)

## Phase 2: 見た目作り (UI 開発)

- [x] レイアウト作成 (ヘッダー・フッター)
- [x] 旅行条件入力フォームの作成
- [x] プラン表示画面のモックアップ作成

## Phase 3: 頭脳作り (API/ロジック連携)

- [x] Gemini API (3.0 Flash) の接続テスト (実装完了)
- [x] 旅行プラン生成用プロンプトの設計
- [x] Server Actions / API Route の実装
- [x] 生成中のローディング表示の実装

## Phase 4: ブラッシュアップ (仕上げ)

- [x] Gemini モデルを最新の `gemini-3-flash-preview` に更新
- [x] フォームに「こだわり条件」入力欄を追加
- [x] フォームに「旅行時期（いつ頃？）」入力欄を追加し、季節に合わせた提案ロジックを実装
- [x] エラーハンドリングの強化 (親しみやすいエラー表示への改善)
- [x] 日本語コメントの徹底とコードのリファクタリング (Gemini による愛の解説付き)
- [x] ローディング中に「弾むカバン」アニメーションを追加
- [x] スマホ実機での表示確認・調整
- [x] 最終動作確認

## Phase 5: 機能拡張 (もっと便利に！)

- [x] プラン結果を Markdown 形式でコピーする機能の実装
  - [x] プラン結果画面に「クリップボードにコピー」ボタンを設置
  - [x] プランデータ (`PlanData`) を綺麗な Markdown 文字列に変換するロジックを作成
  - [x] コピー成功時に「コピーしたよ！」というフィードバック（トースト通知など）を表示

## Phase 6: 品質向上 & リファクタリング (プロの領域へ！🚀)

- [x] 🛡️ AI レスポンスの型安全性強化 (`zod`)

  - [x] `zod` ライブラリのインストール
  - [x] `PlanData` に対応する Zod スキーマの定義
  - [x] API ルートで、AI からのレスポンスを `parse` して検証する処理を追加
  - [x] 万が一のフォーマット不正時の再試行ロジック (エラーハンドリングで対応)

- [x] 📱 UI/UX 改善 (アコーディオン表示)

  - [x] `openDays` ステートによる開閉管理の実装
  - [x] 日付ヘッダーをタップ可能なボタンに変更
  - [x] スムーズな開閉アニメーションと回転する矢印アイコンの追加

- [x] 🧩 コンポーネント分割 (コードのお掃除)

  - [x] `PlanResult.tsx` からタイムライン表示部分を `TimelineSection.tsx` に切り出し
  - [x] `PlanResult.tsx` からホテル表示部分を `HotelSection.tsx` に切り出し

- [x] 🔝 ユーザー体験の向上 (スクロール制御)

  - [x] プラン生成時およびリセット時に画面最上部へ自動スクロールする処理を実装

- [x] 🔍 検索連携機能 (クリックで Google 検索)
  - [x] `TimelineSection` のスポット名を Google 検索へのリンクに変更
  - [x] `HotelSection` のホテル名を Google 検索へのリンクに変更
  - [x] リンクには `target="_blank"` を設定して別タブで開くようにする

## Phase 7: 地図機能の搭載 (Leaflet) 🗺️

- [x] 📦 ライブラリの導入
  - [x] `leaflet` と `react-leaflet`、型定義 `@types/leaflet` のインストール
- [x] 🧠 AI ロジックの強化
  - [x] `PlanData` (Zod Schema) に `lat`, `lng` (緯度経度) フィールドを追加
  - [x] プロンプトを更新して、各スポットとホテルの座標を出力させる
- [x] 🗺️ 地図コンポーネントの実装
  - [x] `MapSection.tsx` を作成 (地図表示、ピン立て)
  - [x] Next.js で Leaflet を使うための動的インポート対応 (SSR 回避)
- [x] 📍 画面への統合
  - [x] プラン結果画面に地図を表示し、おすすめスポットにピンを立てる
  - [x] 🔗 ポップアップ連携
    - [x] 地図のピンをクリックした時のポップアップ内の場所名を、Google検索へのリンクにする

## Phase 8: UI/UXの劇的進化 (もっと楽しく！) 🎨

- [x] 🎮 ローディングのエンタメ化
  - [x] プラン生成中のメッセージを数秒ごとにランダムで切り替える (例: 「カフェ検索中...☕️」「ルート計算中...🗺️」)
- [x] 🖼️ ビジュアル選択肢 (リッチなUI)
  - [x] 「旅のスタイル」などの選択肢を、アイコンや写真付きのカード形式に変更して直感的に選べるようにする
- [x] 💬 会話形式フォーム (Stepper UI)
  - [x] 一問一答形式で進むステップ式の入力フォームに変更 (スマホでの操作性向上)

## Phase 9: AI 持ち物リスト & アドバイス機能 🎒

- [x] 🧠 データ構造の定義
  - [x] `PlanData` (Zod Schema) に `packingList` (持ち物リスト) と `advice` (アドバイス) フィールドを追加
- [x] 📝 プロンプトの拡張
  - [x] 季節や行き先に応じた持ち物とアドバイスを生成するようにプロンプトを更新
- [x] 🎨 表示コンポーネントの作成
  - [x] `AdviceSection.tsx` を作成し、チェックリスト形式で持ち物を表示
  - [x] アドバイスをおしゃれなカード形式で表示

## Phase 10: ブランディング & 次世代 UI への刷新 (Fuwari リニューアル) ☁️✨

- [x] 🏷️ アプリの改名
  - [x] アプリ名を「Fuwari (ふわり)」に変更
  - [x] メタデータ、ロゴ、コピーライト、Markdown 署名をすべて統一
- [x] 🎨 グラスモーフィズム UI の導入
  - [x] 淡いグラデーション背景とすりガラス風カード（Glassmorphism）の採用
  - [x] 影と余白を再設計し、空気感のある「抜け感」デザインを実現
- [x] 📱 モバイル UX の徹底改善
  - [x] プログレスバーを「ステップドット UI」に変更し、システム感を払拭
  - [x] `text-balance` 等によるタイポグラフィの最適化（スマホでの不自然な改行を防止）
  - [x] ボタン内のテキスト折り返しや、リストアイコンの歪みを修正
- [x] 🪄 マイクロインタラクションの追加
  - [x] アイコンの浮遊アニメーションや、ホバー時の滑らかな変化を実装

## 現在のステータス: 🎉 全フェーズ完了！「Fuwari」として最高の旅の相棒に生まれ変わったよ！☁️✈️✨

## Phase 11: コード品質の向上 & メンテナンス (更なる高みへ！🚀)

- [x] 🧹 ESLint エラーの解消
  - [x] `MapSection.tsx`: `require('leaflet')` を廃止し、より適切な動的初期化へ変更
  - [x] `MapSection.tsx`: `useEffect` 内の同期的な `setState` による不要な再レンダリングを防止
  - [x] `TravelForm.tsx`: `any` 型を適切な型定義に置き換え
  - [x] `TravelForm.tsx`: 不要な変数 `progressWidth` の削除
- [x] 🧪 動作確認 & ビルドチェック

## Phase 12: デザインリニューアル (Sparkling Summer Theme) 🍹🌊

- [x] 🎨 カラーパレットの刷新
  - [x] `globals.css` の CSS 変数を夏色（オーシャンブルー、レモンイエロー等）に変更
  - [x] 全体のグラデーションを爽やかに調整
  - [x] 視認性向上のため、テキスト色を `Deep Ocean` に変更
- [x] 🫧 背景アニメーションの実装
  - [x] 炭酸の泡がシュワシュワと立ち昇るアニメーションを追加
- [x] 🧊 「Ice Glass」スタイルの適用
  - [x] すりガラスから透明感のある「氷」のような質感へ変更
  - [x] ツヤ感とハイライトを強調
- [x] 🎡 アニメーションとインタラクションの強化
  - [x] ボタンにリップル（波紋）エフェクトを追加
  - [x] ローディングアニメーションを夏仕様（浮き輪など）に変更

## Phase 13: デザイン調整 & コンテンツ適正化 (メリハリ & 汎用性) 📐

- [ ] 📐 角丸の調整 (Sharpen UI)
  - [ ] 過剰な `rounded-full` / `rounded-3xl` を `rounded-xl` / `rounded-lg` に変更し、メリハリを出す
- [x] 📝 コンテンツの汎用化
  - [x] ヒーローメッセージを「夏限定」から「通年」に戻す
  - [x] プレースホルダーやローディングメッセージから季節限定表現を削除
  - [x] 🧹 コードのクリーンアップ

## Phase 14: デザインリセット & シンプル化 (Modern Clean) ⬜️✨

- [x] 🧹 装飾の削除
  - [x] 背景の泡アニメーション (`BackgroundBubbles`) を削除
  - [x] 背景のグラデーションを削除し、クリーンな白/グレーベースに変更
- [x] 🎨 カラー & スタイルの再定義
  - [x] グラデーション文字・ボタンを廃止し、ソリッドカラーに変更
  - [x] `glass-panel` を廃止し、`simple-card`（白背景+極薄ボーダー+淡い影）へ移行
  - [x] テキスト色をニュートラルなダークグレー (`slate-900`) に統一し、可読性を最大化
- [x] 🧩 コンポーネントの修正
  - [x] Header/Footer: シンプルな白背景に変更
  - [x] Form/Result: フラットでモダンなデザインに統一

## Phase 15: 新デザイン適用「Airy Smart」 (可愛さ × 見やすさ) ☁️💎

**コンセプト**: 空に浮かぶような透明感（Pure Airy）と、情報の見やすさ（Smart）の融合。

- [ ] 🎨 **デザインシステム定義 (Tailwind v4)**
  - [ ] `globals.css`: カラーパレット定義 (Sky Blue, Pure White, Pale Pink)
  - [ ] `globals.css`: ベース背景（淡いグラデーション + オーブ）の実装
  - [ ] `globals.css`: ユーティリティクラス作成 (`.glass-card`, `.solid-card`, `.text-gradient`)

- [ ] 🖼️ **基本レイアウトの実装**
  - [ ] `layout.tsx`: アプリ全体の背景適用、フォント設定（Google Fonts: Zen Maru Gothic 等を検討）
  - [ ] `Header.tsx`: グラスモーフィズム適用、ロゴデザイン調整
  - [ ] `Footer.tsx`: シンプルで透明感のあるデザインへ

- [ ] 🧩 **メインコンテンツのスタイリング**
  - [ ] `TravelForm.tsx`:
    - [ ] ステップ表示のデザイン化
    - [ ] 入力フォーム・選択カードの「Airy Smart」化（白カード + 浮遊感）
    - [ ] ボタンデザイン（グラデーション + ホバーエフェクト）
  - [ ] `PlanResult.tsx`:
    - [ ] 結果表示コンテナのデザイン整備

- [ ] 📍 **詳細セクションのスタイリング**
  - [ ] `TimelineSection.tsx`: タイムラインを見やすく、かつ可愛く（Bento Grid風配置など検討）
  - [ ] `HotelSection.tsx`: ホテルカードのデザイン（写真映えするレイアウト）
  - [ ] `AdviceSection.tsx`: 持ち物リスト・アドバイスのカード化
  - [ ] `MapSection.tsx`: 地図コンテナの角丸・影調整

- [ ] ✨ **仕上げ**
  - [ ] アニメーション追加（ふわっと表示、ボタンのインタラクション）
  - [ ] 全体的な余白・フォントサイズのバランス調整
  - [ ] スマホ・PCでのレスポンシブ確認